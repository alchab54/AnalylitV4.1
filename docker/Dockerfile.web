# Image applicative - hérite de la base avec les dépendances
FROM analylit-base-cpu:latest

# Copier le code de l'application. L'utilisateur 'appuser' est déjà défini dans l'image de base.
COPY . .

# Corrige les fins de ligne Windows (\r) et rend le script exécutable
RUN tr -d '\r' < scripts/entrypoint.sh > /tmp/entrypoint-fixed.sh && \
    chmod +x /tmp/entrypoint-fixed.sh && \
    # Remplace le script original par la version corrigée
    mv /tmp/entrypoint-fixed.sh scripts/entrypoint.sh

ENTRYPOINT ["./scripts/entrypoint.sh"]
